<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo: Horarios de Activaci√≥n del Chat - Guiders SDK</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .demo-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .demo-section h2 {
            color: #34495e;
            margin-top: 0;
        }
        .config-example {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
        }
        .config-example pre {
            margin: 0;
            font-size: 14px;
        }
        .status-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 10px 0;
        }
        .status-active {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-inactive {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .controls {
            margin: 20px 0;
        }
        .btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
        }
        .btn-secondary:hover {
            background-color: #545b62;
        }
        .current-time {
            font-size: 18px;
            font-weight: bold;
            color: #495057;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 8px;
        }
        .info-box {
            background-color: #d1ecf1;
            border: 1px solid #b6d4db;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .warning-box {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üïê Demo: Horarios de Activaci√≥n del Chat</h1>
        
        <div class="demo-section">
            <h2>‚è∞ Estado Actual del Chat</h2>
            <div class="current-time" id="current-time">Cargando hora actual...</div>
            <div id="chat-status" class="status-indicator">Verificando estado...</div>
            <div id="next-available" style="margin-top: 10px; font-style: italic;"></div>
        </div>

        <div class="demo-section">
            <h2>üìã Configuraciones de Ejemplo</h2>
            
            <h3>1. Horario Comercial Normal (9:00 - 18:00)</h3>
            <div class="config-example">
                <pre><code>window.GUIDERS_CONFIG = {
    apiKey: 'tu-api-key',
    activeHours: {
        enabled: true,
        timezone: 'America/Mexico_City',
        ranges: [
            { start: '09:00', end: '18:00' }
        ],
        fallbackMessage: 'Nuestro chat est√° disponible de 9:00 AM a 6:00 PM. ¬°Vuelve durante nuestros horarios de atenci√≥n!'
    }
};</code></pre>
            </div>
            <button class="btn" onclick="applyConfig('business')">Aplicar Configuraci√≥n</button>

            <h3>2. Horario Partido (8:00-14:00 y 15:00-17:00)</h3>
            <div class="config-example">
                <pre><code>window.GUIDERS_CONFIG = {
    apiKey: 'tu-api-key',
    activeHours: {
        enabled: true,
        timezone: 'Europe/Madrid',
        ranges: [
            { start: '08:00', end: '14:00' },
            { start: '15:00', end: '17:00' }
        ],
        fallbackMessage: 'Chat disponible: 8:00-14:00 y 15:00-17:00 (CET). ¬°Vuelve en nuestros horarios!'
    }
};</code></pre>
            </div>
            <button class="btn" onclick="applyConfig('split')">Aplicar Configuraci√≥n</button>

            <h3>3. Soporte 24/7</h3>
            <div class="config-example">
                <pre><code>window.GUIDERS_CONFIG = {
    apiKey: 'tu-api-key',
    activeHours: {
        enabled: false  // Deshabilitado = 24/7
    }
};</code></pre>
            </div>
            <button class="btn" onclick="applyConfig('24x7')">Aplicar Configuraci√≥n</button>

            <h3>4. Horario de Noche (22:00 - 06:00)</h3>
            <div class="config-example">
                <pre><code>window.GUIDERS_CONFIG = {
    apiKey: 'tu-api-key',
    activeHours: {
        enabled: true,
        ranges: [
            { start: '22:00', end: '06:00' }  // Cruza medianoche
        ],
        fallbackMessage: 'Soporte nocturno: 22:00 PM - 6:00 AM. Actualmente fuera de servicio.'
    }
};</code></pre>
            </div>
            <button class="btn" onclick="applyConfig('night')">Aplicar Configuraci√≥n</button>
        </div>

        <div class="demo-section">
            <h2>üîß Controles de Prueba</h2>
            <div class="controls">
                <button class="btn" onclick="testChatAvailability()">üîç Verificar Disponibilidad</button>
                <button class="btn" onclick="getCurrentStatus()">üìä Estado Actual</button>
                <button class="btn" onclick="getNextAvailable()">‚è≠Ô∏è Pr√≥ximo Horario</button>
                <button class="btn btn-secondary" onclick="simulateTime()">üïê Simular Horario</button>
            </div>
            
            <div class="info-box">
                <strong>üí° C√≥mo probar:</strong>
                <ol>
                    <li>Aplica una configuraci√≥n de ejemplo</li>
                    <li>Verifica el estado actual del chat</li>
                    <li>Usa "Simular Horario" para probar diferentes horas</li>
                    <li>Observa c√≥mo el bot√≥n del chat aparece/desaparece seg√∫n los horarios</li>
                </ol>
            </div>

            <div class="warning-box">
                <strong>‚ö†Ô∏è Nota:</strong> En esta demo, el chat puede no inicializarse completamente sin una API key v√°lida, 
                pero podr√°s ver el comportamiento de validaci√≥n de horarios en la consola del navegador.
            </div>
        </div>

        <div class="demo-section">
            <h2>üìù Log de Eventos</h2>
            <div id="event-log" style="background-color: #1e1e1e; color: #fff; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px; height: 200px; overflow-y: auto;">
                <div style="color: #00ff00;">[Demo] üïê Sistema de horarios activos cargado</div>
            </div>
        </div>
    </div>

    <!-- Guiders SDK -->
    <script src="../dist/index.js"></script>

    <!-- Demo Script -->
    <script>
        // Configuraciones predefinidas
        const configs = {
            business: {
                enabled: true,
                timezone: 'America/Mexico_City',
                ranges: [{ start: '09:00', end: '18:00' }],
                fallbackMessage: 'Nuestro chat est√° disponible de 9:00 AM a 6:00 PM. ¬°Vuelve durante nuestros horarios de atenci√≥n!'
            },
            split: {
                enabled: true,
                timezone: 'Europe/Madrid',
                ranges: [
                    { start: '08:00', end: '14:00' },
                    { start: '15:00', end: '17:00' }
                ],
                fallbackMessage: 'Chat disponible: 8:00-14:00 y 15:00-17:00 (CET). ¬°Vuelve en nuestros horarios!'
            },
            '24x7': {
                enabled: false
            },
            night: {
                enabled: true,
                ranges: [{ start: '22:00', end: '06:00' }],
                fallbackMessage: 'Soporte nocturno: 22:00 PM - 6:00 AM. Actualmente fuera de servicio.'
            }
        };

        // Configuraci√≥n inicial del SDK
        window.GUIDERS_CONFIG = {
            apiKey: 'demo-key-horarios-activos',
            activeHours: configs.business,
            environment: 'development'
        };

        // Funciones de utilidad
        function logEvent(message) {
            const log = document.getElementById('event-log');
            const timestamp = new Date().toLocaleTimeString();
            log.innerHTML += `<div style="color: #00ff00;">[${timestamp}] ${message}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        function updateCurrentTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = 
                `üïê Hora actual: ${now.toLocaleString('es-ES', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric', 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit' 
                })}`;
        }

        function updateChatStatus() {
            if (window.guiders && window.guiders.isChatActive) {
                const isActive = window.guiders.isChatActive();
                const statusEl = document.getElementById('chat-status');
                const nextEl = document.getElementById('next-available');
                
                if (isActive) {
                    statusEl.textContent = '‚úÖ Chat ACTIVO - Disponible para visitantes';
                    statusEl.className = 'status-indicator status-active';
                    nextEl.textContent = '';
                } else {
                    statusEl.textContent = '‚ùå Chat INACTIVO - Fuera de horarios';
                    statusEl.className = 'status-indicator status-inactive';
                    
                    if (window.guiders.getNextAvailableTime) {
                        const nextTime = window.guiders.getNextAvailableTime();
                        nextEl.textContent = nextTime ? 
                            `‚è∞ Pr√≥ximo horario disponible: ${nextTime}` : 
                            'üìÖ No hay pr√≥ximos horarios configurados';
                    }
                }
                
                logEvent(`üîÑ Estado actualizado: ${isActive ? 'ACTIVO' : 'INACTIVO'}`);
            } else {
                document.getElementById('chat-status').textContent = '‚ö†Ô∏è SDK no inicializado';
                document.getElementById('chat-status').className = 'status-indicator status-inactive';
            }
        }

        // Funciones de control
        function applyConfig(configName) {
            const config = configs[configName];
            
            if (window.guiders && window.guiders.updateActiveHours) {
                const success = window.guiders.updateActiveHours(config);
                logEvent(`üîß Configuraci√≥n "${configName}" ${success ? 'aplicada correctamente' : 'fall√≥ al aplicarse'}`);
            } else {
                // Actualizar configuraci√≥n global para pr√≥xima inicializaci√≥n
                window.GUIDERS_CONFIG.activeHours = config;
                logEvent(`üîß Configuraci√≥n "${configName}" establecida (requiere reinicializaci√≥n del SDK)`);
            }
            
            updateChatStatus();
        }

        function testChatAvailability() {
            if (window.guiders && window.guiders.isChatActive) {
                const isActive = window.guiders.isChatActive();
                const fallbackMessage = window.guiders.getChatFallbackMessage();
                
                logEvent(`üîç Test de disponibilidad: ${isActive ? 'DISPONIBLE' : 'NO DISPONIBLE'}`);
                if (!isActive && fallbackMessage) {
                    logEvent(`üí¨ Mensaje: "${fallbackMessage}"`);
                }
            } else {
                logEvent('‚ùå SDK no disponible para testing');
            }
            updateChatStatus();
        }

        function getCurrentStatus() {
            updateChatStatus();
            updateCurrentTime();
        }

        function getNextAvailable() {
            if (window.guiders && window.guiders.getNextAvailableTime) {
                const nextTime = window.guiders.getNextAvailableTime();
                logEvent(`‚è∞ Pr√≥ximo horario: ${nextTime || 'No configurado'}`);
            } else {
                logEvent('‚ùå Funci√≥n getNextAvailableTime no disponible');
            }
        }

        function simulateTime() {
            const timeInput = prompt('Ingresa una hora para simular (formato HH:MM):', '14:30');
            if (timeInput) {
                logEvent(`üïê Simulando hora: ${timeInput} (funcionalidad de demo)`);
                logEvent(`üí° En implementaci√≥n real, esto modificar√≠a la hora del sistema temporalmente`);
            }
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            // Verificar cuando el SDK est√© listo
            const checkSDK = setInterval(() => {
                if (window.guiders) {
                    logEvent('‚úÖ Guiders SDK inicializado');
                    updateChatStatus();
                    clearInterval(checkSDK);
                    
                    // Verificar estado cada 30 segundos
                    setInterval(updateChatStatus, 30000);
                }
            }, 1000);
            
            logEvent('üöÄ Demo de horarios activos iniciada');
        });
    </script>
</body>
</html>